<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Welcome to My Page</title>
    <link rel="stylesheet" href="public/css/layui.css">
    <link rel="stylesheet" href="public/css/index.css">
</head>

<body>
    <div id="wait">
        <div id="wait-inner">
            <div>加载慢，请耐心等待！......</div>
            <div>LOADING! PLEASE WAIT FOR A WHILE ......</div>
        </div>

    </div>
    <div id="app" style="display: none;">
        <ul class="layui-nav layui-nav-tree" lay-filter="nav" id="menu-tree">
            <!-- 侧边导航: <ul class="layui-nav layui-nav-tree layui-nav-side"> -->
            <li class="layui-nav-item layui-this">
                <a v-bind:lay-href="ResumePath">Resume</a>
            </li>
            <li class="layui-nav-item layui-nav-itemed">
                <a href="javascript:;">Work</a>
                <dl class="layui-nav-child">
                    <dd v-for="work in worklinklist"><a :lay-href="work.path">{{work.name}}</a></dd>
                </dl>
            </li>
        </ul>
        <div class="main-board"></div>
    </div>
    <script type="text/html">
        <li class="layui-nav-item layui-nav-itemed">
            <a href="javascript:;">Work</a>
            <dl class="layui-nav-child">
                <dd><a
                        lay-href="https://view.officeapps.live.com/op/view.aspx?src=http://davidjacksonluther.github.io/resume/View/McDonalds/Competitor Analysis and Solutions.pptx">Competitor
                        Analysis and Solutions.pptx</a></dd>
                <dd><a lay-href="/resume/View/McDonalds/Ideas On Nowadays Digtial Marketing.pdf">Ideas On Nowadays
                        Digtial Marketing.pdf</a></dd>
                <dd><a
                        lay-href="https://view.officeapps.live.com/op/view.aspx?src=http://davidjacksonluther.github.io/resume/View/McDonalds/Analysis.xlsx">Analysis.xlsx</a>
                </dd>
            </dl>
        </li>
    </script>
    <script type="text/javascript" src="public/json/company.js"></script>
    <script type="text/javascript" src="public/js/vue.js"></script>
    <!-- <script type="text/javascript" src="public/js/pdf.js"></script> -->
    <script type="text/javascript" src="public/layui.js"></script>
    <script type="text/javascript" src="public/js/jquery.js"></script>
    <script type="text/javascript" src="public/js/util.js"></script>
    <script type="text/javascript">
        $("#wait").remove();
        $("#app").show();
        layui.use(["element"], function () {
            var loadingindex = layer.load(0); //风格1的加载
            window.vm = new Vue({

                el: "#app",
                data: {
                    ResumePath: '#',
                    company: {},
                    worklinklist: []
                },
                mounted: function () {

                }
            });



            var companycode = getUrlArg("id");
            console.log(companycode);
            layer.close(loadingindex);
            if (!companycode) {

                layer.alert("对不起！您无权限查看我的简历! Sorry! Don't you have any access to my resume!");
                return;
            }
            ShowResume(companycode);
            AddMenu();
        });
    </script>
    <script type="text/javascript">
        function ShowResume(companycode) {
            for (var i in companylist) {
                var company = vm.company = companylist[i];
                var code = company.code;
                var folder = company.folder;
                var resumeflag = company.resume;
                var resume = company["resume_" + resumeflag];
                var coverletterflag = company.coverletter;
                var coverletter = "";
                if (coverletterflag) {
                    coverletter = company["coverletter_" + coverletterflag];
                }

                if (code == companycode) {
                    vm.ResumePath = "https://view.officeapps.live.com/op/view.aspx?src=http://davidjacksonluther.github.io/resume/View/" + folder + "/" + resume;

                    $(".main-board").html("<iframe src=\"" + vm.ResumePath + "\"></iframe>");
                    $(document).on({
                        'click': function (elem) {
                            var href = $(this).attr("lay-href");
                            if (href == "index.html" || href == "#") {
                                return;
                            }
                            $(".main-board").html("<iframe src=\"" + href + "\"></iframe>");
                        }
                    }, "a[lay-href]");
                }
            }
        }
        function AddMenu() {
            var company = vm.company;
            var folder = company.folder;
            var worklist = company.worklist;
            var html = '<li class="layui-nav-item layui-nav-itemed"\>\
                            <a href="javascript:;">Work</a>\
                            <dl class="layui-nav-child">\
                        ';
            var worklinklist = [];
            for (var i in worklist) {
                var work = worklist[i];
                var suffix = work.suffix;
                var name = work.name;
                var officeApi = "";
                switch (suffix) {
                    case 'docx':
                    case 'pptx':
                    case 'xlsx': { officeApi = "https://view.officeapps.live.com/op/view.aspx?src=http://davidjacksonluther.github.io/resume/View/"; }; break;
                    case 'pdf': {
                        officeApi = "/resume/View/";
                    }
                }
                var path = officeApi + folder + '/' + name;
                worklinklist.push({ "path": path, "name": name });
                vm.worklinklist = worklinklist;
                // html += ' <dd><a lay-href="' + path + '" >' + name + '</a></dd>';
            }
            // html += '</dl>\
            // // </li>';
            // $("#menu-tree").append(html);
        }
    </script>
</body>

</html>